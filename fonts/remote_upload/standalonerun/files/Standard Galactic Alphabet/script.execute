// IIFE to encapsulate the script and prevent global scope pollution
(() => {
  const base64Zip = "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ASUAAP7bAkkBJQAA/tsCSQElAAD+2/yTBbcAAPpJBbcBJAAA/twAAAADAAAG2wgACAAAAwAHAAsAAAEBAQEBAQEBAQEBAQAAAAABJAAAASUAAANtAAABJQAAASUAAAbbASUAAP7bAAABJQAA/tsAAAElAAD+2wAAAAIAAAEkA20IAAADAAsAAAEBAQEBAQEBAQEBAQJJAAABJAAA/twAAP23AAACSQAAASQAAAEkASUAAP7bAkkBJQAAASQAAAJKAAD7bQACAAADbQW2BJIAAwAHAAABAQEBAQEBAQAAAAABJAAAASUAAANtAAADbQElAAD+2wAAASUAAP7bAAEAAANtBJIEkgADAAABAQEBAAAAAASSAAADbQElAAD+2wAAAAMAAANtCAAEkgADAAcACwAAAQEBAQEBAQEBAQEBAAAAAAEkAAABJQAAA20AAAElAAABJQAAA20BJQAA/tsAAAElAAD+2wAAASUAAP7bAAAAAwAAASQEkggAAAMACwAPAAABAQEBAQEBAQEBAQEBAQEBAkkAAAEkAAD8kwAAASQAAAElAAD+2wAAAkkAAAElAAADbQJJAAD9t/23BtwAAPttAAD+3AAA/tsEkgJKAAD9tgAAAAQAAAEkBJIG2wADAAcACwAPAAABAQEBAQEBAQEBAQEBAQEBASQAAAJJAAAAAAAAASUAAPtuAAABJAAAAAAAAAJJAAABJAElAAD+2wElAkkAAP23AkkBJAAA/twBJAElAAD+2wACAAABJAW2CAAABQAJAAABAQEBAQEBAQEBA20AAAElAAABJAAA+koAAANtAAABJASSAAD8kwAA/tsFtwElAAD+2wAAAAIAAAEkA20G2wADAAcAAAEBAQEBAQEBAAAAAAJJAAAAAAAAASQAAAEkASUAAP7bAkkDbgAA/JIAAgAAASQEkgW2AAUACQAAAQEBAQEBAQEBAQJJAAD+2wAAAkkAAPyTAAAEkgAAASQBJQAAASQAAP23A24BJAAA/twAAAAEAAABJASSBtsAAwAHAAsADwAAAQEBAQEBAQEBAQEBAQEBAQNtAAABJQAA+24AAAJJAAD9twAAASQAAAElAAABJAAAASQCSQAA/bcCSQElAAD+2wJJASUAAP7b/twCSQAA/bcABAAAASQFtggAAAMABwALAA8AAAEBAQEBAQEBAQEBAQEBAQECSQAA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ASQFtgSSAAMABwALAAABAQEBAQEBAQEBAQEAAAAABbYAAPtuAAABJQAAASQAAAElAAABJAElAAD+2wJJASUAAP7bAAABJQAA/tsAAAACAAABJAW2CAAAAwALAAABAQEBAQEBAQEBAQEAAAAABbYAAPpKAAACSQAAASQAAAJJAAABJAElAAD+2wJJASUAAANuAAD8kgAA/tsAAwAAASQDbQSSAAMABwALAAABAQEBAQEBAQEBAQEAAAAAASQAAAElAAABJAAA/bcAAAElAAABJAElAAD+2wAAASUAAP7bAkkBJQAA/tsAAAAGAAABJAW2BtsAAwAHAAsADwATABcAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQAAAAABJAAAAAAAAAElAAAAAAAAASQAAAAAAAABJQAA+24AAAEkAAADbgAAASQAAAEkASUAAP7bASUBJAAA/twBJAElAAD+2wElASQAAP7cASQBJQAA/tsAAAElAAD+2wACAAABJANtCAAAAwAHAAABAQEBAQEBAQAAAAABJAAAASUAAAEkAAABJAbcAAD5JAAABtwAAPkkAAMAAAEkBJIG2wADAAcACwAAAQEBAQEBAQEBAQEBAAAAAAEkAAACSQAAASUAAPySAAACSQAAASQEkgAA+24AAASSAAD7bgSSASUAAP7bAAAAAwAAASQDbQbbAAMABwALAAABAQEBAQEBAQEBAQECSQAAASQAAP7cAAABJAAA/JMAAAEkAAACSQEkAAD+3AJJASQAAP7c/JIFtwAA+kkAAAADAAABJASSCAAAAwAHAA8AAAEBAQEBAQEBAQEBAQEBAQEBJAAAASUAAP23AAABJAAAAkkAAP7cAAABJAAAASUAAANtAkkAAP23AkkCSgAA/bb7bgElAAABJAAABJMAAPkkAAAAAwAAASQDbQbbAAMABwALAAABAQEBAQEBAQEBAQEAAAAAASQAAP7cAAABJAAAASUAAAEkAAACSQEkAAD+3AJJASQAAP7c/JIFtwAA+kkAAAACAAABJAW2BtsABwALAAABAQEBAQEBAQEBAQECSQAA/bcAAAW2AAD9twAA/JMAAAW2AAABJAJJAAABJQAA/tsAAP23BJIBJQAA/tsAAQAAASQFtgJJAAMAAAEBAQEAAAAABbYAAAEkASUAAP7bAAAAAQEkBtsDbQgAAAMAAAEB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AHIAIABkAGUAcwBjAHIAaQBwAHQAaQBvAG4AOgAgADwAcAA+AEEAIAB2AGEAcgBpAGEAdABpAG8AbgAgAG8AZgAgAHQAaABlACAAZgBvAG4AdAAgAHUAcwBlAGQAIABmAG8AcgAgAHQAaABlACAAbQBpAG4AZQBjAHIAYQBmAHQAIABlAG4AYwBoAGEAbgB0AG0AZQBuAHQAIAB0AGEAYgBsAGUAIABhAG4AZAAgAHQAaABlACAAYwBvAG0AbQBhAG4AZABlAHIAIABrAGUAZQBuACAAZwBhAG0AZQBzAC4AIABBAGwAbAAgAGMAaABhAHIAYQBjAHQAZQByAHMAIABoAGEAdgBlACAAYgBlAGUAbgAgAGMAaABhAG4AZwBlAGQAIAB0AGgAYQB0ACAAaQB0ACAAYQBsAGwAbwB3AGUAZAAgAG0AZQAgAHQAbwAsACAAZQB2AGUAbgAgAG8AbgBlAHMAIAB0AGgAYQB0ACAAdwBlAHIAZQAgAG4AZQB2AGUAcgAgAHUAcwBlAGQAIABpAG4AIAB0AGgAbwBzAGUAIABnAGEAbQBlAHMALgAgAEkAIABoAG8AcABlACAAdABoAGkAcwAgAGgAZQBsAHAAcwAgADoAMwA8AC8AcAA+AAoAaAB0AHQAcABzADoALwAvAGYAbwBuAHQAcwB0AHIAdQBjAHQALgBjAG8AbQAvAGYAbwBuAHQAcwB0AHIAdQBjAHQAaQBvAG4AcwAvAHMAaABvAHcALwAyADUAMwA0ADQAMgA5AC8AcwBnAGEALQBmAG8AbgB0AC0AMwBoAHQAdABwAHMAOgAvAC8AZgBvAG4AdABzAHQAcgB1AGMAdAAuAGMAbwBtAC8AZgBvAG4AdABzAHQAcgB1AGMAdABvAHIAcwAvAHMAaABvAHcALwAyADQAOQAyADcAMgAzAC8AZABpAGEAbQBvAG4AZAA1ADkANQBGAG8AbgB0AFMAdAByAHUAYwB0ACAATgBvAG4ALQBDAG8AbQBtAGUAcgBjAGkAYQBsACAATABpAGMAZQBuAHMAZQBGAGkAdgBlACAAYgBpAGcAIABxAHUAYQBjAGsAaQBuAGcAIAB6AGUAcABoAHkAcgBzACAAagBvAGwAdAAgAG0AeQAgAHcAYQB4ACAAYgBlAGQAQQBBAHcATABjAFYAMQBtAFYAdwA9AD1Db3B5cmlnaHQgRGlhbW9uZDU5NSAyMDI0U0dBIEZvbnRSZWd1bGFyU0dBIEZvbnRTR0EgRm9udCBSZWd1bGFyVmVyc2lvbiAxLjBTR0FGb250Rm9udFN0cnVjdCBpcyBhIHRyYWRlbWFyayBvZiBGb250U3RydWN0LmNvbWh0dHBzOi8vZm9udHN0cnVjdC5jb21EaWFtb25kNTk10lNHQSBGb2500yB3YXMgYnVpbHQgd2l0aCBGb250U3RydWN0RGVzaWduZXIgZGVzY3JpcHRpb246IDxwPkEgdmFyaWF0aW9uIG9mIHRoZSBmb250IHVzZWQgZm9yIHRoZSBtaW5lY3JhZnQgZW5jaGFudG1lbnQgdGFibGUgYW5kIHRoZSBjb21tYW5kZXIga2VlbiBnYW1lcy4gQWxsIGNoYXJhY3RlcnMgaGF2ZSBiZWVuIGNoYW5nZWQgdGhhdCBpdCBhbGxvd2VkIG1lIHRvLCBldmVuIG9uZXMgdGhhdCB3ZXJlIG5ldmVyIHVzZWQgaW4gdGhvc2UgZ2FtZXMuIEkgaG9wZSB0aGlzIGhlbHBzIDozPC9wPmh0dHBzOi8vZm9udHN0cnVjdC5jb20vZm9udHN0cnVjdGlvbnMvc2hvdy8yNTM0NDI5L3NnYS1mb250LTNodHRwczovL2ZvbnRzdHJ1Y3QuY29tL2ZvbnRzdHJ1Y3RvcnMvc2hvdy8yNDkyNzIzL2RpYW1vbmQ1OTVGb250U3RydWN0IE5vbi1Db21tZXJjaWFsIExpY2Vuc2VGaXZlIGJpZyBxdWFja2luZyB6ZXBoeXJzIGpvbHQgbXkgd2F4IGJlZEFBd0xjVjFtVnc9PQBDAG8AcAB5AHIAaQBnAGgAdAAgAEQAaQBhAG0AbwBuAGQANQA5ADUAIAAyADAAMgA0AFMARwBBACAARgBvAG4AdABSAGUAZwB1AGwAYQByAFMARwBBACAARgBvAG4AdABTAEcAQQAgAEYAbwBuAHQAIABSAGUAZwB1AGwAYQByAFYAZQByAHMAaQBvAG4AIAAxAC4AMABTAEcAQQBGAG8AbgB0AEYAbwBuAHQAUwB0AHIAdQBjAHQAIABpAHMAIABhACAAdAByAGEAZABlAG0AYQByAGsAIABvAGYAIABGAG8AbgB0AFMAdAByAHUAYwB0AC4AYwBvAG0AaAB0AHQAcABzADoALwAvAGYAbwBuAHQAcwB0AHIAdQBjAHQALgBjAG8AbQBEAGkAYQBtAG8AbgBkADUAOQA1IBwAUwBHAEEAIABGAG8AbgB0IB0AIAB3AGEAcwAgAGIAdQBpAGwAdAAgAHcAaQB0AGgAIABGAG8AbgB0AFMAdAByAHUAYwB0AAoARABlAHMAaQBnAG4AZQByACAAZABlAHMAYwByAGkAcAB0AGkAbwBuADoAIAA8AHAAPgBBACAAdgBhAHIAaQBhAHQAaQBvAG4AIABvAGYAIAB0AGgAZQAgAGYAbwBuAHQAIAB1AHMAZQBkACAAZgBvAHIAIAB0AGgAZQAgAG0AaQBuAGUAYwByAGEAZgB0ACAAZQBuAGMAaABhAG4AdABtAGUAbgB0ACAAdABhAGIAbABlACAAYQBuAGQAIAB0AGgAZQAgAGMAbwBtAG0AYQBuAGQAZQByACAAawBlAGUAbgAgAGcAYQBtAGUAcwAuACAAQQBsAGwAIABjAGgAYQByAGEAYwB0AGUAcgBzACAAaABhAHYAZQAgAGIAZQBlAG4AIABjAGgAYQBuAGcAZQBkACAAdABoAGEAdAAgAGkAdAAgAGEAbABsAG8AdwBlAGQAIABtAGUAIAB0AG8ALAAgAGUAdgBlAG4AIABvAG4AZQBzACAAdABoAGEAdAAgAHcAZQByAGUAIABuAGUAdgBlAHIAIAB1AHMAZQBkACAAaQBuACAAdABoAG8AcwBlACAAZwBhAG0AZQBzAC4AIABJACAAaABvAHAAZQAgAHQAaABpAHMAIABoAGUAbABwAHMAIAA6ADMAPAAvAHAAPgAKAGgAdAB0AHAAcwA6AC8ALwBmAG8AbgB0AHMAdAByAHUAYwB0AC4AYwBvAG0ALwBmAG8AbgB0AHMAdAByAHUAYwB0AGkAbwBuAHMALwBzAGgAbwB3AC8AMgA1ADMANAA0ADIAOQAvAHMAZwBhAC0AZgBvAG4AdAAtADMAaAB0AHQAcABzADoALwAvAGYAbwBuAHQAcwB0AHIAdQBjAHQALgBjAG8AbQAvAGYAbwBuAHQAcwB0AHIAdQBjAHQAbwByAHMALwBzAGgAbwB3AC8AMgA0ADkAMgA3ADIAMwAvAGQAaQBhAG0AbwBuAGQANQA5ADUARgBvAG4AdABTAHQAcgB1AGMAdAAgAE4AbwBuAC0AQwBvAG0AbQBlAHIAYwBpAGEAbAAgAEwAaQBjAGUAbgBzAGUARgBpAHYAZQAgAGIAaQBnACAAcQB1AGEAYwBrAGkAbgBnACAAegBlAHAAaAB5AHIAcwAgAGoAbwBsAHQAIABtAHkAIAB3AGEAeAAgAGIAZQBkAEEAQQB3AEwAYwBWADEAbQBWAHcAPQA9AAAAAAMAAAAAAAAAzABmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAA=="; // Replace with your actual base64 string

  // Function to dynamically load JSZip
  function loadJSZip() {
    return new Promise((resolve, reject) => {
      const existingScript = document.querySelector('script[src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"]');
      if (existingScript) {
        console.log('JSZip is already loaded.');
        return resolve();
      }

      const script = document.createElement('script');
      script.src = "https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js";
      script.onload = resolve;
      script.onerror = reject;
      document.head.appendChild(script);
    });
  }

  // Function to check if the base64 string is a ZIP file
  function isZipFile(base64Data) {
    const binaryString = atob(base64Data.slice(0, 100)); // Decode a portion of the base64 string
    const zipSignature = [80, 75, 3, 4]; // PK\x03\x04
    return zipSignature.every((byte, index) => binaryString.charCodeAt(index) === byte);
  }

  // Function to process ZIP file
  async function processZip(base64Data) {
    console.log('Processing as ZIP file...');

    // Convert base64 to binary
    const binaryString = atob(base64Data);
    const byteArray = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      byteArray[i] = binaryString.charCodeAt(i);
    }

    // Use JSZip to unzip
    const zip = await JSZip.loadAsync(byteArray);

    // Extract font and .txt file
    let fontBlob, txtContent;
    await Promise.all(
      Object.keys(zip.files).map(async (fileName) => {
        if (fileName.endsWith('.ttf') || fileName.endsWith('.woff') || fileName.endsWith('.woff2')) {
          console.log(`Found font file: ${fileName}`);
          fontBlob = await zip.files[fileName].async('blob');
        } else if (fileName.endsWith('.txt')) {
          console.log(`Found text file: ${fileName}`);
          txtContent = await zip.files[fileName].async('string');
        }
      })
    );

    // Print .txt file content
    if (txtContent) {
      console.log('TXT Content:', txtContent);
    } else {
      console.warn('No .txt file found in the ZIP.');
    }

    // Load the font
    if (fontBlob) {
      const fontUrl = URL.createObjectURL(fontBlob);
      const fontFace = new FontFace('DynamicFont', `url(${fontUrl})`);
      document.fonts.add(fontFace);

      // Apply the font to the body
      fontFace.load().then(() => {
        document.body.style.fontFamily = 'DynamicFont, sans-serif';
        console.log('Font loaded and applied successfully.');
      });
    } else {
      console.warn('No font file found in the ZIP.');
    }
  }

  // Function to process a standalone font file
  function processFont(base64Data) {
    console.log('Processing as standalone font file...');

    const binaryString = atob(base64Data);
    const byteArray = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      byteArray[i] = binaryString.charCodeAt(i);
    }

    const fontBlob = new Blob([byteArray]);
    const fontUrl = URL.createObjectURL(fontBlob);
    const fontFace = new FontFace('DynamicFont', `url(${fontUrl})`);
    document.fonts.add(fontFace);

    // Apply the font to the body
    fontFace.load().then(() => {
      document.body.style.fontFamily = 'DynamicFont, sans-serif';
      console.log('Font loaded and applied successfully.');
    });
  }

  // Main function to determine and process the input
  async function processBase64(base64Data) {
    try {
      if (isZipFile(base64Data)) {
        console.log('Detected ZIP file format.');
        await processZip(base64Data);
      } else {
        console.log('Detected standalone font file format.');
        processFont(base64Data);
      }
    } catch (error) {
      console.error('Error during processing:', error);
    }
  }

  // Load JSZip and process the base64 data
  loadJSZip()
    .then(() => {
      console.log('JSZip loaded successfully.');
      processBase64(base64Zip);
    })
    .catch((err) => {
      console.error('Failed to load JSZip:', err);
    })
    .finally(() => {
      console.log('Clearing base64Zip and other variables.');
      // Clear variables to avoid re-declaration issues
      window.base64Zip = undefined;
    });
})();
